# {{ ansible_managed }}
# ansibleguy.linux_bootstrap

# custom config
Port {{ ssh_config.port | default(default_ssh_config.port) }}
PermitRootLogin {% if ssh_config.allow_root | default(default_ssh_config.allow_root) %}yes{% else %}no{% endif %}

{% if ssh_config.auth_multi | default(default_ssh_config.auth_multi) %}
AuthenticationMethods "publickey,password"
PasswordAuthentication yes
PubkeyAuthentication yes

{% else %}
PubkeyAuthentication {% if ssh_config.auth_pwd | default(default_ssh_config.auth_pwd) %}yes{% else %}no{% endif %}

PasswordAuthentication {% if ssh_config.auth_pubkey | default(default_ssh_config.auth_pubkey) %}yes{% else %}no{% endif %}
{% endif %}


# login messages
{% if ssh_config.msg | default(default_ssh_config.msg) %}
Banner /etc/ssh/banner.txt
{% endif %}

# these should only be changed if really needed
Protocol 2
SyslogFacility AUTH
LogLevel INFO
MaxAuthTries 5
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding no
ClientAliveInterval 1800
AcceptEnv LANG LC_*
Subsystem       sftp    /usr/lib/openssh/sftp-server
PrintMotd no
